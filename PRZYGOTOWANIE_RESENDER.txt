# ğŸš§ DEV MODE - ZMIANY DO USUNIÄ˜CIA PRZED PRODUKCJÄ„

## âš ï¸ WAÅ»NE: 
Te zmiany zostaÅ‚y dodane TYMCZASOWO aby pokazywaÄ‡ kod weryfikacyjny w alertcie, poniewaÅ¼ Resend z `onboarding@resend.dev` moÅ¼e wysyÅ‚aÄ‡ tylko na email `easylesson.dev@gmail.com`.

**JAK SKONFIGURUJESZ DOMENÄ˜ W RESEND - USUÅƒ TE ZMIANY!**

---

# ğŸ“ PLIK 1: `backend/main.py`

## ğŸ”´ ZMIANA #1 - Endpoint `/api/register` (linia ~55-60)

### âŒ BYÅO (PRODUKCYJNE):
```python
# WyÅ›lij email z kodem weryfikacyjnym
await email_service.send_verification_email(new_user.email, new_user.username, verification_code)

return {"user": new_user, "message": "UÅ¼ytkownik zarejestrowany. SprawdÅº email."}
```

### âœ… JEST TERAZ (DEV MODE):
```python
# WyÅ›lij email z kodem weryfikacyjnym
await email_service.send_verification_email(new_user.email, new_user.username, verification_code)

# ğŸš§ DEV MODE - zwrÃ³Ä‡ kod w response (usuÅ„ przed produkcjÄ…!)
return {
    "user": new_user, 
    "message": "UÅ¼ytkownik zarejestrowany. SprawdÅº email.",
    "verification_code": verification_code  # â† USUÅƒ TÄ˜ LINIÄ˜!
}
```

### ğŸ”§ CO ZROBIÄ† PRZED PRODUKCJÄ„:
**USUÅƒ** liniÄ™:
```python
    "verification_code": verification_code  # â† USUÅƒ!
```

**Zostaw tylko:**
```python
return {
    "user": new_user, 
    "message": "UÅ¼ytkownik zarejestrowany. SprawdÅº email."
}
```

---

## ğŸ”´ ZMIANA #2 - Endpoint `/api/resend-code` (linia ~130)

### âŒ BYÅO (PRODUKCYJNE):
```python
await email_service.send_verification_email(user.email, user.username, verification_code)

return {"message": "Nowy kod wysÅ‚any na email"}
```

### âœ… JEST TERAZ (DEV MODE):
```python
await email_service.send_verification_email(user.email, user.username, verification_code)

# ğŸš§ DEV MODE - zwrÃ³Ä‡ kod
return {
    "message": "Nowy kod wysÅ‚any na email",
    "verification_code": verification_code  # â† USUÅƒ TÄ˜ LINIÄ˜!
}
```

### ğŸ”§ CO ZROBIÄ† PRZED PRODUKCJÄ„:
**USUÅƒ** liniÄ™:
```python
    "verification_code": verification_code  # â† USUÅƒ!
```

**Zostaw tylko:**
```python
return {"message": "Nowy kod wysÅ‚any na email"}
```

---

# ğŸ“ PLIK 2: `src/app/rejestracja/page.tsx`

## ğŸ”´ ZMIANA #3 - Funkcja `handleRegister` (linia ~155)

### âŒ BYÅO (PRODUKCYJNE):
```typescript
console.log("âœ… UÅ¼ytkownik zarejestrowany! ID:", response.user.id);
console.log("ğŸ“§ Kod wysÅ‚any na email:", formData.email);

// Redirect do weryfikacji
router.push(`/weryfikacja?userId=${response.user.id}&email=${encodeURIComponent(formData.email)}`);
```

### âœ… JEST TERAZ (DEV MODE):
```typescript
console.log("âœ… UÅ¼ytkownik zarejestrowany! ID:", response.user.id);
console.log("ğŸ“§ Kod wysÅ‚any na email:", formData.email);

// ğŸš§ DEV MODE - pokaÅ¼ kod jeÅ›li jest w response
if ((response as any).verification_code) {
  alert(`ğŸ”‘ KOD WERYFIKACYJNY: ${(response as any).verification_code}\n\nSkopiuj ten kod!`);
}

// Redirect do weryfikacji
router.push(`/weryfikacja?userId=${response.user.id}&email=${encodeURIComponent(formData.email)}`);
```

### ğŸ”§ CO ZROBIÄ† PRZED PRODUKCJÄ„:
**USUÅƒ** te 4 linie:
```typescript
// ğŸš§ DEV MODE - pokaÅ¼ kod jeÅ›li jest w response
if ((response as any).verification_code) {
  alert(`ğŸ”‘ KOD WERYFIKACYJNY: ${(response as any).verification_code}\n\nSkopiuj ten kod!`);
}
```

---

# ğŸ“ PLIK 3: `src/app/weryfikacja/page.tsx`

## ğŸ”´ ZMIANA #4 - Funkcja `handleResendCode` (linia ~183)

### âŒ BYÅO (PRODUKCYJNE):
```typescript
try {
  await resendVerificationCode(parseInt(userId!));
  
  setResendMessage("âœ… Nowy kod wysÅ‚any na email!");
  setResendCooldown(60);
  console.log("ğŸ“§ Kod ponownie wysÅ‚any");

  // WyczyÅ›Ä‡ wiadomoÅ›Ä‡ po 5 sekundach
  setTimeout(() => setResendMessage(""), 5000);

} catch (error: any) {
  setError(error.message || "BÅ‚Ä…d przy wysyÅ‚aniu kodu");
  console.error("âŒ BÅ‚Ä…d resend:", error);
} finally {
  setResendLoading(false);
}
```

### âœ… JEST TERAZ (DEV MODE):
```typescript
try {
  const data = await resendVerificationCode(parseInt(userId!));
  
  setResendMessage("âœ… Nowy kod wysÅ‚any na email!");
  
  // ğŸš§ DEV MODE - pokaÅ¼ kod jeÅ›li jest
  if ((data as any).verification_code) {
    alert(`ğŸ”‘ NOWY KOD: ${(data as any).verification_code}`);
  }
  
  setResendCooldown(60);
  console.log("ğŸ“§ Kod ponownie wysÅ‚any");

  // WyczyÅ›Ä‡ wiadomoÅ›Ä‡ po 5 sekundach
  setTimeout(() => setResendMessage(""), 5000);

} catch (error: any) {
  setError(error.message || "BÅ‚Ä…d przy wysyÅ‚aniu kodu");
  console.error("âŒ BÅ‚Ä…d resend:", error);
} finally {
  setResendLoading(false);
}
```

### ğŸ”§ CO ZROBIÄ† PRZED PRODUKCJÄ„:
**USUÅƒ** te 4 linie:
```typescript
  // ğŸš§ DEV MODE - pokaÅ¼ kod jeÅ›li jest
  if ((data as any).verification_code) {
    alert(`ğŸ”‘ NOWY KOD: ${(data as any).verification_code}`);
  }
```

**ZMIEÅƒ:**
```typescript
const data = await resendVerificationCode(parseInt(userId!));
```

**NA:**
```typescript
await resendVerificationCode(parseInt(userId!));
```

---

# âœ… CHECKLIST - PRZED PRODUKCJÄ„ (GDY DOMENA GOTOWA):

## Krok 1: Skonfiguruj domenÄ™ w Resend
- [ ] KupiÅ‚em domenÄ™
- [ ] DodaÅ‚em rekordy DNS
- [ ] Domena zweryfikowana w Resend
- [ ] ZaktualizowaÅ‚em `FROM_EMAIL` w Render na `noreply@twoja-domena.xyz`

## Krok 2: UsuÅ„ DEV MODE z kodu

### Backend (`backend/main.py`):
- [ ] UsunÄ…Å‚em `"verification_code": verification_code` z `/api/register` (linia ~60)
- [ ] UsunÄ…Å‚em `"verification_code": verification_code` z `/api/resend-code` (linia ~135)

### Frontend (`src/app/rejestracja/page.tsx`):
- [ ] UsunÄ…Å‚em blok `if ((response as any).verification_code)` z `handleRegister` (linia ~158)

### Frontend (`src/app/weryfikacja/page.tsx`):
- [ ] UsunÄ…Å‚em blok `if ((data as any).verification_code)` z `handleResendCode` (linia ~185)
- [ ] ZmieniÅ‚em `const data = await` na `await` w `handleResendCode`

## Krok 3: Commit i deploy
```bash
git add backend/main.py src/app/rejestracja/page.tsx src/app/weryfikacja/page.tsx
git commit -m "Remove DEV MODE - production ready with custom domain"
git push origin main
```

## Krok 4: Test
- [ ] ZarejestrowaÅ‚em siÄ™ z dowolnym emailem
- [ ] Email przyszedÅ‚ poprawnie (nie ma alertu z kodem!)
- [ ] Weryfikacja dziaÅ‚a
- [ ] Wszystko dziaÅ‚a jak produkcja

---

# ğŸ” JAK SZYBKO ZNALEÅ¹Ä† TE ZMIANY:

## W VS Code:
1. NaciÅ›nij `Ctrl + Shift + F` (Search w wszystkich plikach)
2. Szukaj: `DEV MODE`
3. Znajdziesz wszystkie miejsca do usuniÄ™cia!

## Lub szukaj komentarzy:
```
ğŸš§ DEV MODE
```

---

# ğŸ“ NOTATKI:

**Data dodania DEV MODE:** 29 paÅºdziernika 2025

**PowÃ³d:** Resend z `onboarding@resend.dev` moÅ¼e wysyÅ‚aÄ‡ tylko na `easylesson.dev@gmail.com`. 
Tymczasowe rozwiÄ…zanie - pokazywanie kodu w alertcie dla testÃ³w z dowolnymi emailami.

**Do usuniÄ™cia:** Gdy domena bÄ™dzie zweryfikowana w Resend i `FROM_EMAIL` zmieniony na `noreply@twoja-domena.xyz`

---

# âš ï¸ DLACZEGO TO WAÅ»NE:

**BezpieczeÅ„stwo:** Pokazywanie kodu weryfikacyjnego w response API to **OGROMNA DZIURA BEZPIECZEÅƒSTWA**!

KtoÅ› mÃ³gÅ‚by:
- ZarejestrowaÄ‡ siÄ™ cudzym emailem
- Od razu zobaczyÄ‡ kod
- ZweryfikowaÄ‡ konto bez dostÄ™pu do emaila

**Dlatego to TYLKO dla developmentu, NIGDY dla produkcji!**

---

**Zachowaj ten plik i usuÅ„ DEV MODE jak tylko skonfigurujesz domenÄ™!** ğŸ”’


# ğŸš€ PRZEWODNIK: Konfiguracja Domeny z Resend

## ğŸ“‹ CZEGO POTRZEBUJESZ:
- Domeny (np. `platforma-edukacyjna.xyz`, `twoja-nazwa.com`)
- DostÄ™p do panelu DNS domeny
- 10-60 minut na propagacjÄ™ DNS

---

## ğŸ¯ CEL:
WysyÅ‚ka emaili weryfikacyjnych na **dowolny** adres email (nie tylko TwÃ³j).

---

# CZÄ˜ÅšÄ† 1: ZAKUP DOMENY

## Gdzie kupiÄ‡ taniÄ… domenÄ™:

### **OPCJA 1: Namecheap (polecam!)**
- URL: https://www.namecheap.com
- Domena `.xyz` = **$1-2/rok** (najlepsza cena!)
- Domena `.com` = **$10-15/rok**
- Prosty panel DNS

### **OPCJA 2: Cloudflare**
- URL: https://www.cloudflare.com/products/registrar/
- Domena `.com` = **$10/rok** (cena bez marÅ¼y)
- Åšwietny panel, szybkie DNS

### **OPCJA 3: Porkbun**
- URL: https://porkbun.com
- RÃ³Å¼ne domeny = **$2-15/rok**
- Prosty interface

---

## Co kupiÄ‡:

PrzykÅ‚ady dobrych nazw:
- `platforma-edukacyjna.xyz` ğŸ’° (najtaniej!)
- `easylesson.dev` ğŸ“
- `twoja-nazwa.com` ğŸŒ

**Kup domenÄ™ i przejdÅº dalej!**

---

# CZÄ˜ÅšÄ† 2: DODANIE DOMENY W RESEND

## Krok 1: Zaloguj siÄ™ do Resend
1. IdÅº na https://resend.com
2. Zaloguj siÄ™ (ten sam email co wczeÅ›niej: `easylesson.dev@gmail.com`)

## Krok 2: Dodaj domenÄ™
1. Kliknij **"Domains"** (lewy sidebar)
2. Kliknij **"Add Domain"** (niebieski przycisk)
3. Wpisz swojÄ… domenÄ™: `twoja-domena.xyz`
4. Wybierz **"Subdomain"** lub **"Root domain"**
   - **Root domain** (`twoja-domena.xyz`) - email bÄ™dzie `noreply@twoja-domena.xyz`
   - **Subdomain** (`mail.twoja-domena.xyz`) - email bÄ™dzie `noreply@mail.twoja-domena.xyz`
   
   **Polecam: Root domain** (prostsze)

5. Kliknij **"Add Domain"**

## Krok 3: Skopiuj DNS Records
Resend pokaÅ¼e Ci **3-4 rekordy DNS** do dodania:

### BÄ™dÄ… wyglÄ…daÄ‡ mniej wiÄ™cej tak:

#### **1. MX Record** (wysyÅ‚ka emaili)
```
Type: MX
Name: @ (lub twoja-domena.xyz)
Value: feedback-smtp.us-east-1.amazonses.com
Priority: 10
TTL: Auto lub 3600
```

#### **2. TXT Record #1** (weryfikacja SPF)
```
Type: TXT
Name: @ (lub twoja-domena.xyz)
Value: v=spf1 include:amazonses.com ~all
TTL: Auto lub 3600
```

#### **3. TXT Record #2** (DKIM - weryfikacja)
```
Type: TXT
Name: resend._domainkey (lub coÅ› podobnego)
Value: p=MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB... (dÅ‚ugi klucz)
TTL: Auto lub 3600
```

#### **4. CNAME Record** (tracking - opcjonalny)
```
Type: CNAME
Name: em1234 (lub podobne)
Value: u12345678.wl123.sendgrid.net (lub podobne)
TTL: Auto lub 3600
```

**WAÅ»NE:** Skopiuj DOKÅADNIE te wartoÅ›ci z Resend - bÄ™dÄ… inne dla Twojej domeny!

**Zostaw tÄ™ stronÄ™ otwartÄ… - przejdziemy do panelu domeny!**

---

# CZÄ˜ÅšÄ† 3: KONFIGURACJA DNS W PANELU DOMENY

## Dla Namecheap:

### Krok 1: OtwÃ³rz panel DNS
1. Zaloguj siÄ™ na https://namecheap.com
2. **Dashboard** â†’ **Domain List**
3. ZnajdÅº swojÄ… domenÄ™ â†’ kliknij **"Manage"**
4. ZakÅ‚adka **"Advanced DNS"**

### Krok 2: Dodaj rekordy
Dla kaÅ¼dego rekordu z Resend:

1. Kliknij **"Add New Record"**
2. Wybierz **Type** (MX, TXT, CNAME)
3. Wpisz **Host** (Name z Resend, np. `@` lub `resend._domainkey`)
4. Wpisz **Value** (skopiuj DOKÅADNIE z Resend)
5. Dla MX: ustaw **Priority** na `10`
6. TTL: `Automatic` lub `3600`
7. Kliknij **"Save Changes"**

PowtÃ³rz dla wszystkich 3-4 rekordÃ³w!

---

## Dla Cloudflare:

### Krok 1: OtwÃ³rz panel DNS
1. Zaloguj siÄ™ na https://dash.cloudflare.com
2. Wybierz swojÄ… domenÄ™
3. Kliknij **"DNS"** â†’ **"Records"**

### Krok 2: Dodaj rekordy
Dla kaÅ¼dego rekordu z Resend:

1. Kliknij **"Add record"**
2. **Type**: wybierz (MX, TXT, CNAME)
3. **Name**: wpisz z Resend (np. `@`, `resend._domainkey`)
4. **Content**: skopiuj Value z Resend
5. **TTL**: `Auto`
6. **Proxy status**: ğŸ”´ **DNS only** (WAÅ»NE! WyÅ‚Ä…cz proxy!)
7. Kliknij **"Save"**

PowtÃ³rz dla wszystkich rekordÃ³w!

---

## Dla innych providerÃ³w:

OgÃ³lna zasada:
1. ZnajdÅº **"DNS Management"** lub **"DNS Records"**
2. Dodaj kaÅ¼dy rekord z Resend:
   - **Type**: MX, TXT, lub CNAME
   - **Name/Host**: dokÅ‚adnie z Resend
   - **Value/Content**: dokÅ‚adnie z Resend
   - **Priority**: 10 (tylko dla MX)
   - **TTL**: Auto lub 3600

---

# CZÄ˜ÅšÄ† 4: WERYFIKACJA W RESEND

## Krok 1: Poczekaj na propagacjÄ™ DNS
- Minimum: **10 minut**
- Maksimum: **48 godzin** (zazwyczaj ~1 godzina)

SprawdÅº status:
1. WrÃ³Ä‡ do Resend â†’ **Domains**
2. Twoja domena pokaÅ¼e status:
   - â³ **Pending** - czekaj
   - âœ… **Verified** - GOTOWE!
   - âŒ **Failed** - sprawdÅº rekordy DNS

## Krok 2: Wymuszenie sprawdzenia (opcjonalne)
W Resend kliknij **"Verify"** przy domenie - sprawdzi ponownie.

---

# CZÄ˜ÅšÄ† 5: AKTUALIZACJA BACKENDU (RENDER)

Gdy domena jest **zweryfikowana** w Resend:

## Krok 1: Render Dashboard
1. IdÅº na https://dashboard.render.com
2. ZnajdÅº projekt **platforma-edukacyjna**
3. Kliknij na niego

## Krok 2: Edytuj Environment Variables
1. Kliknij **"Environment"** (lewy sidebar)
2. ZnajdÅº **`FROM_EMAIL`**
3. Kliknij **"Edit"** (oÅ‚Ã³wek)
4. **ZMIEÅƒ wartoÅ›Ä‡ z:**
   ```
   onboarding@resend.dev
   ```
   **NA:**
   ```
   noreply@twoja-domena.xyz
   ```
   (UÅ¼yj SWOJEJ domeny!)
5. Kliknij **"Save Changes"**

## Krok 3: Redeploy
Render automatycznie zrestartuje backend - poczekaj ~30 sekund.

---

# CZÄ˜ÅšÄ† 6: TEST!

## SprawdÅº czy dziaÅ‚a:

1. IdÅº na TwojÄ… aplikacjÄ™ (Vercel URL)
2. Zarejestruj siÄ™ z **DOWOLNYM** emailem (np. `test@gmail.com`)
3. SprawdÅº skrzynkÄ™ odbiorczÄ… (oraz SPAM!)
4. PowinieneÅ› dostaÄ‡ email z kodem weryfikacyjnym

---

# ğŸ‰ GOTOWE!

Teraz moÅ¼esz wysyÅ‚aÄ‡ emaile na **dowolny** adres!

---

# ğŸ“Š PODSUMOWANIE - CO ZMIENIAMY:

## Resend:
- âœ… Dodana domena
- âœ… Domena zweryfikowana

## DNS (Namecheap/Cloudflare):
- âœ… Dodane rekordy MX, TXT, CNAME

## Render (Backend):
- âœ… `FROM_EMAIL` = `noreply@twoja-domena.xyz`

## Vercel (Frontend):
- âŒ **NIC** - frontend nie wymaga zmian!

---

# âš ï¸ TROUBLESHOOTING

## Problem: "Domain not verified" w Resend
**RozwiÄ…zanie:**
1. SprawdÅº czy rekordy DNS sÄ… dodane DOKÅADNIE jak w Resend
2. Poczekaj dÅ‚uÅ¼ej (do 24h)
3. UÅ¼yj narzÄ™dzia: https://mxtoolbox.com/SuperTool.aspx
   - Wpisz swojÄ… domenÄ™
   - SprawdÅº czy widzi rekordy MX, SPF, DKIM

## Problem: "550 5.7.1 Unauthenticated email from domain"
**RozwiÄ…zanie:**
- SprawdÅº rekord SPF (TXT): `v=spf1 include:amazonses.com ~all`
- SprawdÅº rekord DKIM (TXT z `_domainkey`)

## Problem: Email trafia do SPAM
**RozwiÄ…zanie:**
- Dodaj rekord DMARC (opcjonalny):
  ```
  Type: TXT
  Name: _dmarc
  Value: v=DMARC1; p=none; rua=mailto:twoj-email@twoja-domena.xyz
  ```
- Poczekaj kilka dni - nowe domeny czÄ™sto trafiajÄ… do SPAM
- Testuj z rÃ³Å¼nymi providerami (Gmail, Outlook, etc.)

## Problem: "Domain already exists"
**RozwiÄ…zanie:**
- Domena moÅ¼e byÄ‡ dodana w innym koncie Resend
- UsuÅ„ jÄ… z tamtego konta lub uÅ¼yj subdomeny: `mail.twoja-domena.xyz`

---

# ğŸ”— PRZYDATNE LINKI

- Resend Dashboard: https://resend.com/domains
- Render Dashboard: https://dashboard.render.com
- MX Toolbox (test DNS): https://mxtoolbox.com
- Mail Tester (test emaili): https://www.mail-tester.com

---

# ğŸ’¡ DODATKOWE WSKAZÃ“WKI

## Rekomendowany email sender:
```
noreply@twoja-domena.xyz
```

## MoÅ¼liwe warianty:
```
hello@twoja-domena.xyz
support@twoja-domena.xyz
team@twoja-domena.xyz
```

## Custom sender name:
W `backend/email_service.py` moÅ¼esz zmieniÄ‡:
```python
from_email="Platforma Edukacyjna <noreply@twoja-domena.xyz>"
```

---

# âœ… CHECKLIST - ZAZNACZ JAK ZROBISZ:

- [ ] KupiÅ‚em domenÄ™
- [ ] DodaÅ‚em domenÄ™ w Resend
- [ ] DodaÅ‚em rekordy DNS w panelu domeny
- [ ] Domena zweryfikowana w Resend (âœ…)
- [ ] ZaktualizowaÅ‚em `FROM_EMAIL` w Render
- [ ] PrzetestowaÅ‚em rejestracjÄ™ z nowym emailem
- [ ] Email przyszedÅ‚ poprawnie
- [ ] Weryfikacja dziaÅ‚a

---

**Powodzenia! ğŸš€**

Jak skoÅ„czysz setup, przetestuj z rÃ³Å¼nymi emailami (Gmail, Outlook, Yahoo) Å¼eby upewniÄ‡ siÄ™ Å¼e wszystko dziaÅ‚a!